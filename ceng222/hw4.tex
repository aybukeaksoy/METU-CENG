\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{float}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{graphicx}

\usepackage[hmargin=3cm,vmargin=6.0cm]{geometry}
\topmargin=-2cm
\addtolength{\textheight}{6.5cm}
\addtolength{\textwidth}{2.0cm}
\setlength{\oddsidemargin}{0.0cm}
\setlength{\evensidemargin}{0.0cm}
\usepackage{indentfirst}
\usepackage{amsfonts}

\begin{document}

\section*{Student Information}

Name : Ayb√ºke Aksoy\\

ID : 2448090\\


\section*{Answer 1}
\paragraph{a)}
We can calculate the minimum sample size of the Monte Carlo simulation as:
\[N \geq 0.25\frac{z_{\alpha/2}}{\varepsilon}\]
\[\varepsilon=0.02 \ , \ \alpha=0.01\]
\[N \geq 0.25\frac{2.5758}{0.02}\]
\[N \geq 4146.8\]
\[N=4147\]
\paragraph{b)}
Expected value for a poison distribution is $\lambda$ and expected value for a gamma distribution is $\frac{\alpha}{\lambda}$.\\\\
The expected value for the weight of an automobile:
\[E(W_A)=\frac{190}{0.15}=1266.6\]
The expected value for the weight of a truck:
\[E(W_T)=\frac{110}{0.01}=11000\]
The expected value for the number of automobiles:
\[E(N_A)=50\]
The expected value for the number of trucks:
\[E(N_T)=10\]
For independent random variables:
\[E(X*Y)=E(X)*E(Y)\]
The expected value for the total weight of the automobiles:
\[E(W_A)*E(N_A)=1266.6*50=63330\]
The expected value for the total weight of the trucks:
\[E(W_T)*E(N_T)=11000*10=110000\]
\section*{Answer 2}
\begin{figure}[H]
\centerline{\includegraphics[width=15cm, height=4cm]{variables.png}}
\label{fig}
\end{figure}
In this part, I have defined the variables that will be used during the calculations. 
N is the size of this Monte Carlo study with 0.02 error and 0.09 probability. We have found its value from the formula in part A. \\\\
The variables $an \textunderscore lambda$, $tn \textunderscore lambda$, $aw \textunderscore lambda$, $tn \textunderscore lambda$, $aw \textunderscore alpha$, $tw \textunderscore alpha$ are defined as; the $\lambda$ of poisson distribution for the number of automobiles, the $\lambda$ of poisson distribution for the number of trucks, the $\lambda$ of gamma distribution for the weight of an automobile, the $\lambda$ of gamma distribution for the weight of a truck, the $\alpha$ of gamma distribution for the weight of  an automobile, the $\alpha$ of gamma distribution for the weight of  a truck respectively. Their values are given in the homework text.\\\\
The vector totalWeight is created with size N to hold the total weights.
\begin{figure}[H]
\centerline{\includegraphics[width=15cm, height=5cm]{function.png}}
\label{fig}
\end{figure}
In this part, I have defined a function called calculateweight that accepts the $\lambda$ and $\alpha$ variables of the distributions as parameters and returns the total weight. \\
First, a random variable U is created with Matlab's rand function, variable F which will be used as our poisson cdf function and variable i to keep track of the number of automobiles and trucks. \\\\
During the while loop, we compare the value of the random variable U with the poisson cdf function F. Until F becomes greater than U, we continue the loop and only increment the value of i and update the poisson cdf F.\\\\
When the loop ends, variable i is the number of automobiles or trucks.
To find the total weight of an automobile or a truck, we use the formula given in the book for the gamma distribution with the specific $\lambda$ and $\alpha$ values. 
\begin{figure}[H]
\centerline{\includegraphics[width=15cm, height=8cm]{forloop.png}}
\label{fig}
\end{figure}
In this part, to be able to estimate the probability, total weight and standart deviation with the error and probability given in the homework, we run the for loop for N times which is the size of the monte carlo simulation.\\\\
We call the calculateweight function for automobiles and trucks separately with their specific $\lambda$ and $\alpha$ values and store the return values of these calls in the variables aw and tw which represents total weight of automobiles and trucks respectively. 
Lastly, we sum these values (aw and tw) and put them into the kth index of the totalWeight vector. This vector will hold the total weight values coming from each run of the for loop. \\\\
Finally, we estimate the probability that the total weight of all the vehicles that pass over the bridge on a day is more than 200 tons by taking the mean of the values in totalWeight vector that are greater than 200000, estimate the expected weight by taking the mean of the values in totalWeight and estimate the standart deviation by using the std function of Matlab on totalWeight vector. 
\begin{figure}[H]
\centerline{\includegraphics[width=10cm, height=4cm]{output.png}}
\label{fig}
\end{figure}
Those are the outputs for each estimation we get from our Monte Carlo simulation. These values can change at each run as we use rand function during the calculations but they have to be in some interval with respect to our error and probability values in the beginning meaning that the simulation should satisfy 0.02 error margin with probability 0.99. 
Using the values we found in part 1, 
The expected total weight of all vehicles:
\[110000+63333=173333\]
With $\varepsilon$=0.02, margin of error is:
\[173333*0.02=3466.7\]
Therefore the interval is;
\[[169866.3 \ , \ 176799.7]\]
Since our estimated values fall in the interval for almost all of the runs, we can say that we have an accurate estimation.



\end{document}



